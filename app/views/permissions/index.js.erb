<% js = escape_javascript(
  render(partial: 'permissions/list', locals: { permission_modules: @permission_modules })
) %>
$("#permissions_list").html("<%= js %>");

$(".perm-mod-toggle-button").on('change', function(e){
  const parent = $(e.target).closest('.card');
  const permissions = parent.find('.perm-toggle-button');
  permissions.each((index, permission) => {
    $(permission).prop('checked', $(e.target).is(':checked'));
    $(permission).siblings("input[type='hidden']").val(!$(e.target).is(':checked'));
  });
});
$(".perm-toggle-button").on('change', function(e){
  $(e.target).siblings("input[type='hidden']").val(!$(e.target).is(':checked'));
});

$('#remote_form_sector').on('changed.bs.select', function (e, clickedIndex, isSelected, previousValue) {
  $(e.target).closest('form').submit();
});
