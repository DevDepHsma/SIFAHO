<%= render 'shared/flash_message' %>

$("#"+"<%= @tr_id.to_s %>").find('td.actions-col').first().fadeOut(250, function(e){
  $("#"+"<%= @tr_id.to_s %>").find('.btn-ipp-save').tooltip('hide');
  $("#"+"<%= @tr_id.to_s %>").find('td.actions-col').first().html('<%= j render("inpatient_prescriptions/partials/select_lot_stocks_btn", order: @inpatient_prescription_product.order, f_object: @inpatient_prescription_product) %>');
  $("#"+"<%= @tr_id.to_s %>").find('td.actions-col').first().fadeIn();
  initActionsButton($("#"+"<%= @tr_id.to_s %>"));
  <%# Se agrega el evento al boton para seleccionar lotes, y se hace click sobre el mismo %>
  <% if @inpatient_prescription_product.parent.present? %>
    $("#"+"<%= @tr_id.to_s %>").find('button.btn-select-lot-stock').first().on('click', function(e) {
      e.stopPropagation();
      const urlFindLots = $(e.target).attr("data-select-lot-url");
      const orderName = $(e.target).attr("data-order-name");
      const orderId = $(e.target).attr("data-order-id");
      const orderProductId = $(e.target).attr("data-order-product-id");
      const productId = $(e.target).closest('tr').find('input[type="hidden"].product-id').first().val();
      $.ajax({
        url: urlFindLots,
        method: 'GET',
        dataType: "script",
        data: {
          order_type: orderName,
          order_id: orderId,
          order_product_id: orderProductId,
          product_id: productId
      }});
    }).trigger('click');
  <% end %>
  $("#"+"<%= @tr_id.to_s %>").find(".order-product-inputs").attr("readonly", true);
  $("#"+"<%= @tr_id.to_s %>").attr('id', "<%= @inpatient_prescription_product.parent.present? ? "child-" : "parent-" %><%= @inpatient_prescription_product.id %>");
})