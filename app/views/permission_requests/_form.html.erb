<%= simple_form_for @permission_request, url: create_permission_requests_path do |f| %>
  <%= f.error_notification %>

  <%= f.input :establishment_id,
    as: :select,
    label: '¿A cuál establecimiento pertenece?',
    include_blank: false,
    collection: @establishments.map {|establishment|  [establishment.name, establishment.id]} + [["Otro...", 0]],
    :input_html => {
      placeholder: 'Seleccionar establecimiento',
      required: true,
      class: 'selectpicker custom-select-pick',
      "title"=>"Seleccionar establecimiento",
      "data-width"=>"100%",
      "data-size"=>"10",
      "data-live-search"=>true,
      "data-none-results-text" => "No se encontró el establecimiento",
      "data-request-url" => request_sectors_permission_requests_path,
      value: f.object.establishment_id.present? ? f.object.establishment_id : ""
    }
  %>

  <%#= f.input :establishment_id, label: '¿A cuál establecimiento pertenece?' do %>
    <%#= f.select :establishment_id, @establishments.map {|establishment|  [establishment.name, establishment.id]} + [["Otro...", nil]],
      {},
      {
        class: 'selectpicker custom-select-pick',
        "data-width"=>"100%",
        "data-size"=>"10",
        "title"=>"Seleccionar establecimiento",
        "data-live-search"=>true,
        "data-none-results-text" => "No se encontró el establecimiento",
        "data-request-url" => request_sectors_permission_requests_path,
        selected: f.object.establishment_id.present? ? f.object.establishment_id : ""
      }
    %>
  <%# end %>
  
  <div id="sector-selector">
    <% if @sectors.present? %>
      <%= render('permission_requests/partials/sector_select') %>
    <% elsif @permission_request.establishment_id.present? %>
      <%= render(partial: 'permission_requests/partials/establishment_and_sector_inputs') %>
    <% end %>
  </div>
  
  <div class="form-inputs">
    <%#= f.input :role, label: "¿Qué rol cumple?", placeholder: "Ej. Farmacéutico" %>
    <%= f.input :observation, label: "Observaciones" %>
  </div>
<% end %>
