"use strict";!function(t){"object"==typeof module&&module.exports?module.exports=t:t(Highcharts)}(function(t){!function(v){var w=v.each,D=v.pick,r=v.win,s=r.document,t=v.seriesTypes,l=s.createElement("a").download!==undefined;v.setOptions({exporting:{csv:{columnHeaderFormatter:null,dateFormat:"%Y-%m-%d %H:%M:%S",itemDelimiter:",",lineDelimiter:"\n"},showTable:!1},lang:{downloadCSV:"Download CSV",downloadXLS:"Download XLS",viewData:"View data table"}}),v.addEvent(v.Chart.prototype,"render",function(){this.options&&this.options.exporting&&this.options.exporting.showTable&&this.viewData()}),v.Chart.prototype.setUpKeyToAxis=function(){t.arearange&&(t.arearange.prototype.keyToAxis={low:"y",high:"y"})},v.Chart.prototype.getDataRows=function(){var o,t,m,e,n,a,i,h=this.options.exporting&&this.options.exporting.csv||{},f=this.xAxis,u={},r=[],g=[],y=function(t,e,o){if(h.columnHeaderFormatter){var n=h.columnHeaderFormatter(t,e,o);if(!1!==n)return n}return t instanceof v.Axis?t.options.title&&t.options.title.text||(t.isDatetimeAxis?"DateTime":"Category"):t?t.name+(1<o?" ("+e+")":""):"Category"},b=[];for(e in m=0,this.setUpKeyToAxis(),w(this.series,function(i){var r,s=i.options.keys||i.pointArrayMap||["y"],l=s.length,p=!i.requireSorting&&{},c={},d={},x=v.inArray(i.xAxis,f);if(w(s,function(t){var e=(i.keyToAxis&&i.keyToAxis[t]||t)+"Axis";c[t]=i[e]&&i[e].categories||[],d[t]=i[e]&&i[e].isDatetimeAxis}),!1!==i.options.includeInCSVExport&&!1!==i.visible){for(v.find(b,function(t){return t[0]===x})||b.push([x,m]),r=0;r<l;)g.push(y(i,s[r],s.length)),r++;w(i.points,function(t,e){var o,n,a=t.x;for(p&&(p[a]&&(a+="|"+e),p[a]=!0),r=0,u[a]||(u[a]=[],u[a].xValues=[]),u[a].x=t.x,u[a].xValues[x]=t.x,i.xAxis&&"name"!==i.exportKey||(u[a].name=t.name);r<l;)n=t[o=s[r]],u[a][m+r]=D(c[o][n],d[o]?v.dateFormat(h.dateFormat,n):null,n),r++}),m+=r}}),u)u.hasOwnProperty(e)&&r.push(u[e]);for(t=[g],m=b.length;m--;)a=b[m][0],i=b[m][1],o=f[a],r.sort(function(t,e){return t.xValues[a]-e.xValues[a]}),n=y(o),t[0].splice(i,0,n),w(r,function(t){var e=t.name;e||(o.isDatetimeAxis?(t.x instanceof Date&&(t.x=t.x.getTime()),e=v.dateFormat(h.dateFormat,t.x)):e=o.categories?D(o.names[t.x],o.categories[t.x],t.x):t.x),t.splice(i,0,e)});return t=t.concat(r)},v.Chart.prototype.getCSV=function(i){var r="",s=this.getDataRows(),t=this.options.exporting.csv,l=t.itemDelimiter,p=t.lineDelimiter;return w(s,function(t,e){for(var o="",n=t.length,a=i?1.1.toLocaleString()[1]:".";n--;)"string"==typeof(o=t[n])&&(o='"'+o+'"'),"number"==typeof o&&","===a&&(o=o.toString().replace(".",",")),t[n]=o;r+=t.join(l),e<s.length-1&&(r+=p)}),r},v.Chart.prototype.getTable=function(r){var s="<table><thead>",t=this.getDataRows();return w(t,function(t,e){var o,n,a=e?"td":"th",i=r?1.1.toLocaleString()[1]:".";for(s+="<tr>",n=0;n<t.length;n+=1)"number"==typeof(o=t[n])?(o=o.toString(),","===i&&(o=o.replace(".",i)),s+="<"+a+' class="number">'+o+"</"+a+">"):s+="<"+a+' class="text">'+(o===undefined?"":o)+"</"+a+">";s+="</tr>",e||(s+="</thead><tbody>")}),s+="</tbody></table>"},v.Chart.prototype.fileDownload=function(t,e,o){var n,a,i;i=this.options.exporting.filename?this.options.exporting.filename:this.title&&this.title.textStr?this.title.textStr.replace(/ /g,"-").toLowerCase():"chart",r.Blob&&r.navigator.msSaveOrOpenBlob?(a=new r.Blob(["\ufeff"+o],{type:"text/csv"}),r.navigator.msSaveOrOpenBlob(a,i+"."+e)):l?((n=s.createElement("a")).href=t,n.download=i+"."+e,this.container.appendChild(n),n.click(),n.remove()):v.error("The browser doesn't support downloading files")},v.Chart.prototype.downloadCSV=function(){var t=this.getCSV(!0);this.fileDownload("data:text/csv,\ufeff"+encodeURIComponent(t),"csv",t,"text/csv")},v.Chart.prototype.downloadXLS=function(){var t="data:application/vnd.ms-excel;base64,",e='<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40"><head><!--[if gte mso 9]><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>Ark1</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--><style>td{border:none;font-family: Calibri, sans-serif;} .number{mso-number-format:"0.00";} .text{ mso-number-format:"@";}</style><meta name=ProgId content=Excel.Sheet><meta charset=UTF-8></head><body>'+this.getTable(!0)+"</body></html>",o=function(t){return r.btoa(unescape(encodeURIComponent(t)))};this.fileDownload(t+o(e),"xls",e,"application/vnd.ms-excel")},v.Chart.prototype.viewData=function(){this.dataTableDiv||(this.dataTableDiv=s.createElement("div"),this.dataTableDiv.className="highcharts-data-table",this.renderTo.parentNode.insertBefore(this.dataTableDiv,this.renderTo.nextSibling)),this.dataTableDiv.innerHTML=this.getTable()};var e=v.getOptions().exporting;e&&(v.extend(e.menuItemDefinitions,{downloadCSV:{textKey:"downloadCSV",onclick:function(){this.downloadCSV()}},downloadXLS:{textKey:"downloadXLS",onclick:function(){this.downloadXLS()}},viewData:{textKey:"viewData",onclick:function(){this.viewData()}}}),e.buttons.contextButton.menuItems.push("separator","downloadCSV","downloadXLS","viewData")),t.map&&(t.map.prototype.exportKey="name"),t.mapbubble&&(t.mapbubble.prototype.exportKey="name"),t.treemap&&(t.treemap.prototype.exportKey="name")}(t)});